<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<StackPane xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.nepaltourismmanagementapp.controller.GuideDashboardController">

   <!-- Background Image -->
   <ImageView fitWidth="1200" fitHeight="800" preserveRatio="false">
      <image>
         <Image url="@../images/nepal-background.jpg" />
      </image>
   </ImageView>

   <!-- Main Content -->
   <BorderPane>
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="header">
            <Label fx:id="welcomeLabel" styleClass="welcome-label" text="Welcome, Guide!">
                <font>
                    <Font name="System Bold" size="18.0" />
                </font>
            </Label>
            <Region HBox.hgrow="ALWAYS" />
            <Button fx:id="languageButton" styleClass="language-button" text="Language" />
            <Button onAction="#handleLogout" styleClass="logout-button" text="Logout" />
            <padding>
                <Insets bottom="15.0" left="20.0" right="20.0" top="15.0" />
            </padding>
        </HBox>
    </top>
    <center>
        <TabPane fx:id="mainTabPane" styleClass="main-tab-pane" tabClosingPolicy="UNAVAILABLE">
            <Tab styleClass="tab" text="Dashboard">
                <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                    <VBox spacing="20.0">
                        <padding>
                            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                        </padding>
                        <Label styleClass="section-title" text="Overview">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                        <HBox spacing="30.0" alignment="CENTER_LEFT">
                            <VBox spacing="10.0" styleClass="stats-box">
                                <Label fx:id="totalBookingsLabel" styleClass="stat-label" text="Total Bookings: 0" />
                                <Label fx:id="totalEarningsLabel" styleClass="stat-label" text="Total Earnings: NPR 0.00" />
                                <Label fx:id="ratingLabel" styleClass="stat-label" text="Rating: 0.0" />
                                <Label fx:id="upcomingBookingsLabel" styleClass="stat-label" text="Upcoming Bookings: 0" />
                            </VBox>
                        </HBox>
                        <Label styleClass="section-title" text="Recent Bookings">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                        <TableView fx:id="bookingsTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="bookingIdCol" prefWidth="100.0" text="Booking ID" />
                                <TableColumn fx:id="touristIdCol" prefWidth="120.0" text="Tourist Username" />
                                <TableColumn fx:id="attractionCol" prefWidth="200.0" text="Attraction" />
                                <TableColumn fx:id="visitDateCol" prefWidth="100.0" text="Visit Date" />
                                <TableColumn fx:id="statusCol" prefWidth="100.0" text="Status" />
                                <TableColumn fx:id="amountCol" prefWidth="100.0" text="Amount (NPR)" />
                            </columns>
                        </TableView>
                        <HBox spacing="10.0" alignment="CENTER_LEFT">
                            <Button onAction="#handleRefreshData" styleClass="primary-button" text="Refresh Data" />
                            <Button onAction="#handleViewAllBookings" styleClass="primary-button" text="ðŸ“… View All Bookings" />
                            <Button onAction="#handleStatistics" styleClass="primary-button" text="ðŸ“Š Statistics" />
                            <Button onAction="#handleUpdateStatus" styleClass="secondary-button" text="Update Status" />
                            <Button onAction="#handleViewTouristInfo" styleClass="secondary-button" text="View Tourist Info" />
                            <Button onAction="#handleReportEmergency" styleClass="emergency-button" text="ðŸš¨ Report Emergency" />
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            <Tab styleClass="tab" text="Profile">
                <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                    <VBox spacing="20.0">
                        <padding>
                            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                        </padding>
                        <Label styleClass="section-title" text="My Profile">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>

                        <!-- Editable Profile Fields -->
                        <GridPane hgap="15.0" vgap="10.0">
                            <columnConstraints>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                            </columnConstraints>
                            <children>
                                <Label text="Full Name:" GridPane.rowIndex="0" GridPane.columnIndex="0" />
                                <TextField fx:id="fullNameField" editable="false" styleClass="form-field" GridPane.rowIndex="0" GridPane.columnIndex="1" />

                                <Label text="Email:" GridPane.rowIndex="1" GridPane.columnIndex="0" />
                                <TextField fx:id="emailField" editable="false" styleClass="form-field" GridPane.rowIndex="1" GridPane.columnIndex="1" />

                                <Label text="Phone:" GridPane.rowIndex="2" GridPane.columnIndex="0" />
                                <TextField fx:id="phoneField" editable="false" styleClass="form-field" promptText="Enter phone number" GridPane.rowIndex="2" GridPane.columnIndex="1" />

                                <Label text="License:" GridPane.rowIndex="3" GridPane.columnIndex="0" />
                                <TextField fx:id="licenseField" editable="false" styleClass="form-field" GridPane.rowIndex="3" GridPane.columnIndex="1" />

                                <Label text="Languages:" GridPane.rowIndex="4" GridPane.columnIndex="0" />
                                <TextField fx:id="languagesField" editable="false" styleClass="form-field" promptText="e.g. English;Nepali" GridPane.rowIndex="4" GridPane.columnIndex="1" />

                                <Label text="Specializations:" GridPane.rowIndex="5" GridPane.columnIndex="0" />
                                <TextField fx:id="specializationsField" editable="false" styleClass="form-field" promptText="e.g. Cultural;Mountain" GridPane.rowIndex="5" GridPane.columnIndex="1" />

                                <Label text="Experience (Years):" GridPane.rowIndex="6" GridPane.columnIndex="0" />
                                <Spinner fx:id="experienceSpinner" editable="false" GridPane.rowIndex="6" GridPane.columnIndex="1" />

                                <Label text="Rating:" GridPane.rowIndex="7" GridPane.columnIndex="0" />
                                <Label fx:id="profileRatingLabel" styleClass="stat-label" GridPane.rowIndex="7" GridPane.columnIndex="1" />
                            </children>
                        </GridPane>

                        <HBox spacing="10.0">
                            <Button fx:id="editProfileButton" onAction="#handleEditProfile" styleClass="primary-button" text="Edit Profile" />
                            <Button fx:id="saveChangesButton" onAction="#handleSaveChanges" styleClass="primary-button" text="Save Changes" visible="false" />
                            <Button fx:id="cancelEditButton" onAction="#handleCancelEdit" styleClass="secondary-button" text="Cancel" visible="false" />
                        </HBox>

                        <!-- The original profileArea can be kept for quick overview or removed if individual fields are preferred -->
                        <!-- <TextArea fx:id="profileArea" editable="false" prefHeight="200.0" prefWidth="200.0" styleClass="text-area" VBox.vgrow="ALWAYS" /> -->
                    </VBox>
                </ScrollPane>
            </Tab>
        </TabPane>
    </center>
</BorderPane>
</StackPane>